<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Escrow Auditor V3</title>
    <link rel="stylesheet" href="style_v3.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>๐ Telegram Escrow Auditor</h1>
            <p class="subtitle">ูุธุงู ุชุญููู ุงูุญุณุงุจุงุช ุงูุขูู</p>
        </header>

        <!-- Progress Steps -->
        <div class="steps">
            <div class="step" id="step-1">
                <div class="step-num">1</div>
                <div class="step-label">ุชุณุฌูู ุงูุฏุฎูู</div>
            </div>
            <div class="step" id="step-2">
                <div class="step-num">2</div>
                <div class="step-label">ุงูุชุญูู</div>
            </div>
            <div class="step" id="step-3">
                <div class="step-num">3</div>
                <div class="step-label">ุชุบููุฑ ุงูุฅูููู</div>
            </div>
            <div class="step" id="step-4">
                <div class="step-num">4</div>
                <div class="step-label">ุงููุญุต ุงูุฃููู</div>
            </div>
            <div class="step" id="step-5">
                <div class="step-num">5</div>
                <div class="step-label">ุงูุฅููุงุก</div>
            </div>
            <div class="step" id="step-6">
                <div class="step-num">6</div>
                <div class="step-label">ุงูุชูุงู</div>
            </div>
        </div>

        <!-- Status Message -->
        <div id="status-message" class="status-box hidden"></div>

        <!-- View 1: Phone Input -->
        <div id="view-phone" class="view">
            <div class="card">
                <h2>๐ฑ ุฅุฏุฎุงู ุฑูู ุงููุงุชู</h2>
                <div class="form-group">
                    <label for="phone-input">ุฑูู ุงููุงุชู (ูุน ุฑูุฒ ุงูุฏููุฉ)</label>
                    <input type="tel" id="phone-input" placeholder="+201234567890" dir="ltr">
                </div>
                <div class="form-group">
                    <label for="transfer-mode">ูุถุน ุงูุชุญููู</label>
                    <select id="transfer-mode">
                        <option value="bot_only">ุงูุจูุช ููุท - ุฎุฑูุฌ ูุงูู ูู ุงูุญุณุงุจ</option>
                        <option value="user_keeps_session">ุงุญุชูุงุธ ุจุฌูุณุฉ - ุงููุณุชุฎุฏู ูุจูู ูุนู ุฌูุณุฉ</option>
                    </select>
                    <small class="hint">
                        <strong>ุงูุจูุช ููุท:</strong> ูุชู ุฅููุงุก ุฌููุน ุฌูุณุงุช ุงููุณุชุฎุฏูุ ุชุจูู ุฌูุณุงุช ุงูุจูุช ููุท<br>
                        <strong>ุงุญุชูุงุธ ุจุฌูุณุฉ:</strong> ุงููุณุชุฎุฏู ูุญุชูุธ ุจุฌูุณุฉ ูุงุญุฏุฉ ูุน ุชุบููุฑ ุงูุฅูููู ููููุฉ ุงููุฑูุฑ
                    </small>
                </div>
                <button id="btn-send-code" onclick="sendCode()" class="btn-primary">
                    ุฅุฑุณุงู ููุฏ ุงูุชุญูู
                </button>
            </div>
        </div>

        <!-- View 2: Code Verification -->
        <div id="view-code" class="view hidden">
            <div class="card">
                <h2>๐ข ุฅุฏุฎุงู ููุฏ ุงูุชุญูู</h2>
                <p>ุชู ุฅุฑุณุงู ููุฏ ุงูุชุญูู ุฅูู ุชุทุจูู ุชูููุฌุฑุงู</p>
                <div class="form-group">
                    <label for="code-input">ููุฏ ุงูุชุญูู</label>
                    <input type="text" id="code-input" placeholder="12345" maxlength="6" dir="ltr">
                </div>
                <button id="btn-verify-code" onclick="verifyCode()" class="btn-primary">
                    ุชุญูู
                </button>
            </div>
        </div>

        <!-- View 2b: 2FA Password -->
        <div id="view-2fa" class="view hidden">
            <div class="card">
                <h2>๐ ุงูุชุญูู ุจุฎุทูุชูู</h2>
                <p>ุงูุญุณุงุจ ูุญูู ุจุงูุชุญูู ุจุฎุทูุชูู</p>
                <div class="form-group">
                    <label for="2fa-input">ูููุฉ ุงููุฑูุฑ</label>
                    <input type="password" id="2fa-input" placeholder="ุฃุฏุฎู ูููุฉ ูุฑูุฑ 2FA">
                    <small id="2fa-hint" class="hint"></small>
                </div>
                <button id="btn-verify-2fa" onclick="verify2FA()" class="btn-primary">
                    ุชุญูู
                </button>
            </div>
        </div>

        <!-- View 3: Email Change -->
        <div id="view-email" class="view hidden">
            <div class="card">
                <h2>๐ง ุชุบููุฑ ุฅูููู ุงูุงุณุชุฑุฏุงุฏ</h2>
                <div id="target-email-display"></div>
                <div id="email-instructions"></div>
                
                <div class="email-actions">
                    <button id="btn-check-code" onclick="checkEmailCode()" class="btn-primary">
                        ุงูุชุญูู ูู ูุตูู ุงูููุฏ
                    </button>
                </div>
                
                <div id="email-code-display" class="code-display"></div>
                
                <button id="btn-confirm-email" onclick="confirmEmailChanged()" class="btn-success hidden">
                    ุชุฃููุฏ ุชุบููุฑ ุงูุฅูููู
                </button>
                
                <button onclick="skipEmailStep()" class="btn-secondary">
                    ุชุฎุทู (ุงูุฅูููู ููุฌูุฏ ูุณุจูุงู)
                </button>
            </div>
        </div>

        <!-- View 4: Security Audit -->
        <div id="view-audit" class="view hidden">
            <div class="card">
                <h2>๐ ุงููุญุต ุงูุฃููู</h2>
                <button id="btn-run-audit" onclick="runAudit()" class="btn-primary">
                    ุจุฏุก ุงููุญุต ุงูุฃููู
                </button>
                <div id="audit-log" class="audit-log"></div>
                <button id="btn-proceed-finalize" onclick="proceedToFinalize()" class="btn-success hidden">
                    ูุชุงุจุนุฉ ููุฅููุงุก
                </button>
            </div>
        </div>

        <!-- View 5: Finalize -->
        <div id="view-finalize" class="view hidden">
            <div class="card">
                <h2>โ ุฅููุงุก ุงูุนูููุฉ</h2>
                <p>ุณูุชู ุฅูุดุงุก ูููุฉ ูุฑูุฑ ูููุฉ ุฌุฏูุฏุฉ ูุญูุธ ุงูุฌูุณุงุช</p>
                
                <div class="form-group">
                    <label for="current-2fa-password">ูููุฉ ูุฑูุฑ 2FA ุงูุญุงููุฉ (ุฅู ูุฌุฏุช)</label>
                    <input type="password" id="current-2fa-password" placeholder="ุงุชุฑููุง ูุงุฑุบุฉ ุฅุฐุง ูู ููู ููุงู 2FA">
                </div>
                
                <div class="warning-box">
                    โ๏ธ <strong>ุชูุจูู:</strong> ุณูุชู:
                    <ul>
                        <li>ุฅูุดุงุก ูููุฉ ูุฑูุฑ 2FA ุฌุฏูุฏุฉ ูููุฉ</li>
                        <li>ุญูุธ ุฌูุณุงุช Pyrogram ู Telethon</li>
                        <li id="mode-action"></li>
                    </ul>
                </div>
                
                <button id="btn-finalize" onclick="finalizeAccount()" class="btn-success">
                    ุฅููุงุก ุงูุนูููุฉ
                </button>
            </div>
        </div>

        <!-- View 6: Complete -->
        <div id="view-complete" class="view hidden">
            <div class="card">
                <div id="complete-message"></div>
                <button onclick="location.reload()" class="btn-primary">
                    ุจุฏุก ุนูููุฉ ุฌุฏูุฏุฉ
                </button>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <p>Telegram Escrow Auditor V3 | <a href="/api/v1/docs/internal" target="_blank">API Documentation</a></p>
        </footer>
    </div>

    <script src="app_v3.js"></script>
    <script>
        function skipEmailStep() {
            setStep(4);
            showView('view-audit');
        }
    </script>
</body>
</html>
